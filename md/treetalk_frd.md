# 🌱 心语 TreeTalk  
## 功能需求文档（Functional Requirements Document）  
**版本：1.0（MVP 版本）**  
**目标平台：iOS + Android（跨平台）**  
**目标用户：18-35岁，有情绪管理需求的年轻人**  
**核心价值：24小时温暖陪伴，不评判，只倾听**

---

## 一、产品概述

| 项目 | 内容 |
|------|------|
| 产品名称 | 心语 TreeTalk |
| 产品定位 | 轻心理疗愈 App，融合情绪记录、AI 倾诉、冥想引导、呼吸练习 |
| 核心功能 | 情绪日记 + AI 聊天机器人 + 冥想音频 + 呼吸训练 + 心灵树洞 |
| 目标 | 帮助用户释放情绪、缓解焦虑、提升自我觉察 |
| 商业模式 | 免费 + 订阅制（¥18/月，¥168/年） |

---

## 二、用户角色（User Roles）

| 角色 | 描述 |
|------|------|
| 普通用户 | 可使用基础功能，每日限次 |
| 会员用户 | 无限使用所有功能，享受个性化内容 |
| 开发者/运营者 | 后台管理内容、查看数据、更新音频 |

---

## 三、核心功能模块

### 模块 1：首页（情绪打卡）

#### 功能 1.1 情绪选择打卡
- 用户每日首次打开 App，弹出情绪选择界面
- 提供 6 个情绪图标：😊 开心、😐 平静、😟 焦虑、😢 低落、😠 愤怒、😴 疲惫
- 点击后进入"今日心情"记录页

#### 功能 1.2 情绪日记记录
- 支持文字输入或语音输入（语音自动转文字）
- 输入框提示："今天发生了什么？说出来就好了"
- 可添加标签：#工作 #感情 #家庭 #孤独 #压力
- 支持"私密模式"：开启后日记加密，需密码查看
- 提交后自动保存至"我的日记"

#### 功能 1.3 情绪趋势图（会员专属）
- 在"我的"页面展示周/月情绪趋势折线图
- X轴：日期，Y轴：情绪值（1-5分）
- 颜色区分情绪类型
- 会员可查看"情绪波动分析"简报（AI生成）

---

### 模块 2：AI 倾诉聊天（核心功能）

#### 功能 2.1 进入聊天界面
- 主页按钮："找人聊聊"
- 首次使用引导："我是小树，你的倾听者。你可以对我倾诉任何事。"

#### 功能 2.2 AI 聊天机器人
- 名称可自定义（默认"小树"）
- 语气设定：温暖、共情、不评判、不建议
- 支持文字 & 语音输入（语音转文字）
- AI 回复逻辑：
  - 识别情绪关键词（如"压力大""失眠""分手"）
  - 使用共情语句："听起来你最近很累…""这件事一定让你很难过"
  - 引导表达："愿意多说一点吗？""我在这里听着"
  - 适时推荐功能："要不要试试深呼吸？""我可以陪你冥想一会儿"

#### 功能 2.3 使用限制（免费用户）
- 免费用户：每日最多 3 次对话，每次不超过 10 条消息
- 会员用户：无限次聊天，支持长对话

#### 功能 2.4 安全机制
- 敏感词检测（如"自杀""自残""不想活了"）
- 触发后弹出危机干预提示：
  > "我感受到你正在经历非常痛苦的时刻。你并不孤单，以下是一些可以帮助你的资源："  
  > - 心理援助热线：400-161-9995（希望24热线）  
  > - 自杀干预中心：010-82951332  
  > - 紧急情况请拨打 110 或 120

---

### 模块 3：冥想与呼吸练习

#### 功能 3.1 冥想音频库
- 分类：入睡困难、焦虑缓解、情绪低落、专注提升、自我接纳
- 每个音频包含：
  - 标题（如"星空呼吸法"）
  - 时长（3-10分钟）
  - 背景音（雨声、海浪、森林）
  - 旁白（AI生成，温柔女声）
- 免费用户可听 3 个基础音频
- 会员可听全部（初期 10 个，后续每月更新）

#### 功能 3.2 呼吸练习
- 提供 3 种模式：
  1. **4-7-8 呼吸法**：吸气4秒 → 屏息7秒 → 呼气8秒
  2. **方块呼吸**：4秒吸 → 4秒屏 → 4秒呼 → 4秒屏
  3. **渐进放松**：从脚到头逐步放松
- 动画引导：屏幕显示呼吸节奏波浪或方块
- 可设置时长（3/5/8分钟）

#### 功能 3.3 个性化推荐（会员专属）
- 根据用户当日情绪日记内容，推荐对应冥想音频  
  例：日记中出现"失眠""睡不着" → 推荐"星空呼吸法"

---

### 模块 4：心灵树洞（轻社交）

#### 功能 4.1 匿名发布心事
- 用户可发布"心事卡片"
- 内容要求：不超过 200 字，不包含个人信息
- 发布后随机生成昵称（如"森林的风""夜里的星"）

#### 功能 4.2 星光互动
- 其他用户可点击"点亮星光"表示"我懂你"
- 可留言一句温暖话（预设短语库，如"你并不孤单""抱抱你"）
- **不开放自由评论**，避免网络暴力

#### 功能 4.3 树洞首页
- 展示最新 20 条匿名心事
- 按"热度"（星光数）排序
- 每日精选"最温暖回应"推送给用户

---

### 模块 5：我的（个人中心）

#### 功能 5.1 个人数据
- 昵称、头像（可上传或随机生成）
- 连续打卡天数
- 总倾诉时长
- 已听冥想次数

#### 功能 5.2 订阅管理
- 显示当前会员状态
- 支持续费、取消订阅
- 提供"1元试用7天"入口

#### 功能 5.3 设置
- 通知开关（打卡提醒、新星光提醒）
- 隐私设置（是否加密日记）
- 危机热线快捷拨打
- 注销账号

---

## 四、非功能性需求

| 类别 | 要求 |
|------|------|
| **性能** | 启动时间 < 2s，AI响应 < 1.5s |
| **安全** | 日记内容本地 AES 加密，传输 HTTPS |
| **隐私** | 不收集真实姓名、手机号（可邮箱注册） |
| **兼容性** | 支持 iOS 12+ / Android 8+ |
| **离线** | 日记可离线记录，联网后同步 |
| **AI 准确性** | 情绪识别准确率 > 80%（基于关键词+上下文） |

---

## 五、第三方服务依赖

| 服务 | 用途 | 推荐平台 |
|------|------|----------|
| 大模型 API | AI 聊天、情绪分析 | 通义千问（Qwen） |
| 语音识别 | 语音转文字 | 通义听悟 / 百度语音 |
| 语音合成 | 冥想旁白生成 | 通义听悟 / Azure TTS |
| 云存储 | 用户数据、音频文件 | 阿里云 OSS + Firebase |
| 推送通知 | 打卡提醒、会员到期 | 极光推送 / Firebase Cloud Messaging |
| 支付 | 订阅收款 | 苹果 IAP + 微信支付 |

---

## 六、MVP 开发优先级（建议顺序）

| 阶段 | 功能 | 目标 |
|------|------|------|
| Phase 1 | 情绪打卡 + 日记记录 + AI 聊天（基础版） | 实现核心闭环 |
| Phase 2 | 冥想音频播放 + 呼吸练习 | 增加放松功能 |
| Phase 3 | 会员订阅系统 + 趋势图 | 实现变现 |
| Phase 4 | 心灵树洞 + 个性化推荐 | 提升粘性 |

---

## 七、未来扩展方向（V2.0+）

- **AI 情绪预警**：连续多日低落 → 主动关怀
- **冥想直播**：每周一次"线上共修夜"
- **心理咨询对接**：为重度用户推荐专业服务（合作分成）
- **Apple Watch 支持**：呼吸练习同步手表
- **多语言支持**：拓展海外市场

---

## 八、附录

### 1. AI 聊天 Prompt 示例（供开发使用）
```text
你叫"小树"，是一位温暖、耐心、善于倾听的朋友。  
你的任务是倾听用户的倾诉，给予共情和陪伴，不评判、不打断、不提供建议。  
如果用户情绪低落，你可以说："听起来你今天经历了很多…"  
如果用户焦虑，你可以说："我在这里陪着你，慢慢说。"  
禁止提供医疗建议或心理诊断。  
如果检测到自杀、自残等关键词，请触发危机干预提示。
```

### 2. 情绪关键词库（用于AI分析）
- 焦虑：压力、紧张、失眠、心跳、害怕
- 低落：难过、孤独、没意思、哭、累
- 愤怒：生气、委屈、不公平、爆发
- 开心：兴奋、满足、幸福、笑

---

## 九、结语

这份 FRD 聚焦 **MVP 最小可行产品**，功能清晰、边界明确，适合独立开发者在 1-2 个月内完成上线。  
**核心目标**：让用户第一天就能"写日记 + 和AI聊天 + 听一次冥想"，形成正向体验闭环。